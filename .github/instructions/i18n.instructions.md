---
applyTo: 'src/**'
description: 'i18n implementation: message key patterns, locale files, pluralization, RTL support.'
---

# Internationalization (i18n) Instructions

General i18n guidance for all workspaces. **For Lancelot extension development**, reference `instructions/lancelot.instructions.md` first.

## Scope & Hierarchy

These instructions are **general** and complement the hierarchy defined in `copilot-instructions.md`:

1. `instructions/lancelot.instructions.md` – Primary source for Lancelot development
2. Domain-specific instructions (TypeScript, Security, Performance, etc.)
3. This file – i18n guidance applicable across projects

## Core Requirements

- **No hardcoded user-facing strings**: Use message keys and resource bundles (e.g., `package.nls.json`, `package.nls.<locale>.json`).
- **Locale-aware formatting**: Use `Intl.DateTimeFormat`, `Intl.NumberFormat`, and similar APIs for dates, times, numbers, and currencies.
- **Unicode & RTL support**: Assume non-Latin scripts and right-to-left text; avoid fixed widths and truncation assumptions.
- **Pluralization & interpolation**: Prefer ICU MessageFormat (or equivalent) to avoid string concatenation and to handle plural forms correctly.
- **Fallbacks**: Provide a default locale (usually `en`) and ensure missing keys fail gracefully.
- **Pseudo-localization**: Implement a pseudo locale for testing expansion, diacritics, and RTL mirroring.
- **Do not localize**: Internal IDs, file paths, logs (unless end-user visible), protocol/format tokens.

## VS Code Extension Patterns

### Using `vscode-nls`

```ts
import * as vscode from 'vscode';
import * as nls from 'vscode-nls';
const localize = nls.loadMessageBundle();

export function activate(context: vscode.ExtensionContext) {
  const disposable = vscode.commands.registerCommand('lancelot.sayHello', () => {
    vscode.window.showInformationMessage(
      localize('cmd.sayHello.message', 'Hello from Lancelot!')
    );
  });
  context.subscriptions.push(disposable);
```
